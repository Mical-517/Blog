---
title: CharArray_s
published: 2026-02-13T20:06:19+08:00
summary: "理解c字符串函数中参数的意义，理解缓冲区"
cover:
  image: https://bucket-qjy.oss-cn-qingdao.aliyuncs.com/picture/202602011340604.png
tags: [c字符串函数参数意义]
categories: '知识点'
draft: false
lang: ''
---

**C 里 `-s` 系列函数（比如 `strcpy_s`、`strcat_s`、`sprintf_s`）里的「缓冲区」到底是什么**。

**缓冲区 = 用来存放字符串的那块 char 数组空间**

你写的：

c运行

```
char buf[100];
```

这里的 `buf` 就是**缓冲区**。

------

# 为什么要带 _s（安全版）

普通函数：

c运行

```
strcpy(dest, src);
```

它**不知道 dest 有多大**，只管无脑复制，很容易**越界、崩溃、漏洞**。

安全函数：

c运行

```
strcpy_s(dest, 缓冲区大小, src);
```

它**必须知道缓冲区多大**，超过就直接拒绝，不越界。

------

# 每个 _s 函数里的「缓冲区」指谁？

### 1. strcpy_s

c运行

```
strcpy_s(目标缓冲区, 大小, 源字符串);
```

- **缓冲区 = 目标数组 dest**
- 大小是 **dest 的容量**，不是字符串长度

### 2. strcat_s

c运行

```
strcat_s(目标缓冲区, 大小, 要追加的串);
```

- **缓冲区 = 存放最终结果的 dest 数组**

### 3. sprintf_s / snprintf

c运行

```
sprintf_s(缓冲区, 大小, "格式串", ...);
```

- **缓冲区 = 存最终拼成字符串的数组**

------

# 最关键的区

- **缓冲区大小**：数组**总字节数**（能装多少字符）
- **字符串长度**：实际字符个数（不包含 `\0`）

例子：

c运行

```
char buf[10];  // 缓冲区大小 = 10
strcpy(buf, "hello");  // 字符串长度 = 5
```

------

# 通俗的记忆

缓冲区 = 装字符串的 “盒子”

缓冲区大小 = 盒子的容量

_s 函数就是：先看盒子够不够大，再往里装东西。

# 总结

就是当我们从source复制到destination的时候，计算机会无脑复制参数中缓冲区大小的字符到目标字符串，所以注意这里缓冲区大小要包含了\0